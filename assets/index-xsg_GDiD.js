import{q as D,d as P,I as g,r as v,J as W,K as q,L as C,w as E,D as L,M,b as i,N as I,O as R,P as A,Q as O,A as $}from"./index-BeP3gcyx.js";import{u as J}from"./use-expose-CQIS9pGU.js";import{o as K}from"./use-route-IHgQ6GTt.js";import{I as p}from"./_plugin-vue_export-helper-B23Ac8Lp.js";const[Q,c]=D("notice-bar"),V={text:String,mode:String,color:String,delay:g(1),speed:g(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var X=P({name:Q,props:V,emits:["close","replay"],setup(e,{emit:m,slots:o}){let l=0,a=0,h;const d=v(),u=v(),t=W({show:!0,offset:0,duration:0}),y=()=>{if(o["left-icon"])return o["left-icon"]();if(e.leftIcon)return i(p,{class:c("left-icon"),name:e.leftIcon},null)},N=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},k=n=>{e.mode==="closeable"&&(t.show=!1,m("close",n))},x=()=>{if(o["right-icon"])return o["right-icon"]();const n=N();if(n)return i(p,{name:n,class:c("right-icon"),onClick:k},null)},S=()=>{t.offset=l,t.duration=0,O(()=>{R(()=>{t.offset=-a,t.duration=(a+l)/+e.speed,m("replay")})})},T=()=>{const n=e.scrollable===!1&&!e.wrapable,s={transform:t.offset?`translateX(${t.offset}px)`:"",transitionDuration:`${t.duration}s`};return i("div",{ref:d,role:"marquee",class:c("wrap")},[i("div",{ref:u,style:s,class:[c("content"),{"van-ellipsis":n}],onTransitionend:S},[o.default?o.default():e.text])])},r=()=>{const{delay:n,speed:s,scrollable:f}=e,B=A(n)?+n*1e3:0;l=0,a=0,t.offset=0,t.duration=0,clearTimeout(h),h=setTimeout(()=>{if(!d.value||!u.value||f===!1)return;const w=I(d).width,b=I(u).width;(f||b>w)&&R(()=>{l=w,a=b,t.offset=-a,t.duration=a/+s})},B)};return K(r),q(r),C("pageshow",r),J({reset:r}),E(()=>[e.text,e.scrollable],r),()=>{const{color:n,wrapable:s,background:f}=e;return L(i("div",{role:"alert",class:c({wrapable:s}),style:{color:n,background:f}},[y(),T(),x()]),[[M,t.show]])}}});const G=$(X);export{G as N};
