import{d as D,Y as O,y as I,q as E,k as V,p as w,ai as ve,b as i,a9 as ye,A as N,x,af as _,r as m,K as me,W as G,X as he,w as P,aF as Ce,z as q,L as J,aG as W,av as Z,$ as ge,P as $,D as Q,M as ee,v as B,j as te,a6 as Oe,F as ke,aH as Se,a1 as we,aA as Ie,an as be,aI as xe,s as Pe,aJ as pe,J as Te,V as ze,au as Be,ae as Ae}from"./index-aGPECSjT.js";import{u as ne}from"./use-expose-Bn8jNSAx.js";import{T as F,H as Le,I as oe}from"./index-A3DcMHlH.js";import{P as _e}from"./on-popup-reopen-CSvVhWC_.js";import{u as K}from"./use-scope-id-BQkzMLrT.js";import{c as De}from"./interceptor-DOYkiFfT.js";const[Ee,z]=E("loading"),Me=Array(12).fill(null).map((e,t)=>i("i",{class:z("line",String(t+1))},null)),Ne=i("svg",{class:z("circular"),viewBox:"25 25 50 50"},[i("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),$e={size:O,type:I("circular"),color:String,vertical:Boolean,textSize:O,textColor:String};var Re=D({name:Ee,props:$e,setup(e,{slots:t}){const n=V(()=>w({color:e.color},ve(e.size))),s=()=>{const a=e.type==="spinner"?Me:Ne;return i("span",{class:z("spinner",e.type),style:n.value},[t.icon?t.icon():a])},o=()=>{var a;if(t.default)return i("span",{class:z("text"),style:{fontSize:ye(e.textSize),color:(a=e.textColor)!=null?a:e.color}},[t.default()])};return()=>{const{type:a,vertical:c}=e;return i("div",{class:z([a,{vertical:c}]),"aria-live":"polite","aria-busy":!0},[s(),o()])}}});const je=N(Re),ae={show:Boolean,zIndex:O,overlay:x,duration:O,teleport:[String,Object],lockScroll:x,lazyRender:x,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:_,transitionAppear:Boolean,closeOnClickOverlay:x},gt=Object.keys(ae);function Ye(e,t){return e>t?"horizontal":t>e?"vertical":""}function Fe(){const e=m(0),t=m(0),n=m(0),s=m(0),o=m(0),a=m(0),c=m(""),l=m(!0),d=()=>c.value==="vertical",k=()=>c.value==="horizontal",v=()=>{n.value=0,s.value=0,o.value=0,a.value=0,c.value="",l.value=!0};return{move:y=>{const h=y.touches[0];n.value=(h.clientX<0?0:h.clientX)-e.value,s.value=h.clientY-t.value,o.value=Math.abs(n.value),a.value=Math.abs(s.value);const C=10;(!c.value||o.value<C&&a.value<C)&&(c.value=Ye(o.value,a.value)),l.value&&(o.value>F||a.value>F)&&(l.value=!1)},start:y=>{v(),e.value=y.touches[0].clientX,t.value=y.touches[0].clientY},reset:v,startX:e,startY:t,deltaX:n,deltaY:s,offsetX:o,offsetY:a,direction:c,isVertical:d,isHorizontal:k,isTap:l}}let p=0;const H="van-overflow-hidden";function Ke(e,t){const n=Fe(),s="01",o="10",a=v=>{n.move(v);const u=n.deltaY.value>0?o:s,f=Ce(v.target,e.value),{scrollHeight:y,offsetHeight:h,scrollTop:C}=f;let g="11";C===0?g=h>=y?"00":"01":C+h>=y&&(g="10"),g!=="11"&&n.isVertical()&&!(parseInt(g,2)&parseInt(u,2))&&q(v,!0)},c=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",a,{passive:!1}),p||document.body.classList.add(H),p++},l=()=>{p&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",a),p--,p||document.body.classList.remove(H))},d=()=>t()&&c(),k=()=>t()&&l();me(d),G(k),he(k),P(t,v=>{v?c():l()})}function se(e){const t=m(!1);return P(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const[He,Ue]=E("overlay"),Xe={show:Boolean,zIndex:O,duration:O,className:_,lockScroll:x,lazyRender:x,customStyle:Object,teleport:[String,Object]};var Ve=D({name:He,inheritAttrs:!1,props:Xe,setup(e,{attrs:t,slots:n}){const s=m(),o=se(()=>e.show||!e.lazyRender),a=l=>{e.lockScroll&&q(l,!0)},c=o(()=>{var l;const d=w(ge(e.zIndex),e.customStyle);return $(e.duration)&&(d.animationDuration=`${e.duration}s`),Q(i("div",B({ref:s,style:d,class:[Ue(),e.className]},t),[(l=n.default)==null?void 0:l.call(n)]),[[ee,e.show]])});return J("touchmove",a,{target:s}),()=>{const l=i(W,{name:"van-fade",appear:!0},{default:c});return e.teleport?i(Z,{to:e.teleport},{default:()=>[l]}):l}}});const Ge=N(Ve),qe=w({},ae,{round:Boolean,position:I("center"),closeIcon:I("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:I("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Je,U]=E("popup");var We=D({name:Je,inheritAttrs:!1,props:qe,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:s}){let o,a;const c=m(),l=m(),d=se(()=>e.show||!e.lazyRender),k=V(()=>{const r={zIndex:c.value};if($(e.duration)){const S=e.position==="center"?"animationDuration":"transitionDuration";r[S]=`${e.duration}s`}return r}),v=()=>{o||(o=!0,c.value=e.zIndex!==void 0?+e.zIndex:Se(),t("open"))},u=()=>{o&&De(e.beforeClose,{done(){o=!1,t("close"),t("update:show",!1)}})},f=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&u()},y=()=>{if(e.overlay){const r=w({show:e.show,class:e.overlayClass,zIndex:c.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return i(Ge,B(r,K(),{onClick:f}),{default:s["overlay-content"]})}},h=r=>{t("clickCloseIcon",r),u()},C=()=>{if(e.closeable)return i(oe,{role:"button",tabindex:0,name:e.closeIcon,class:[U("close-icon",e.closeIconPosition),Le],classPrefix:e.iconPrefix,onClick:h},null)};let g;const ce=()=>{g&&clearTimeout(g),g=setTimeout(()=>{t("opened")})},ie=()=>t("closed"),re=r=>t("keydown",r),ue=d(()=>{var r;const{destroyOnClose:S,round:M,position:A,safeAreaInsetTop:de,safeAreaInsetBottom:fe,show:Y}=e;if(!(!Y&&S))return Q(i("div",B({ref:l,style:k.value,role:"dialog",tabindex:0,class:[U({round:M,[A]:A}),{"van-safe-area-top":de,"van-safe-area-bottom":fe}],onKeydown:re},n,K()),[(r=s.default)==null?void 0:r.call(s),C()]),[[ee,Y]])}),j=()=>{const{position:r,transition:S,transitionAppear:M}=e,A=r==="center"?"van-fade":`van-popup-slide-${r}`;return i(W,{name:S||A,appear:M,onAfterEnter:ce,onAfterLeave:ie},{default:ue})};return P(()=>e.show,r=>{r&&!o&&(v(),n.tabindex===0&&we(()=>{var S;(S=l.value)==null||S.focus()})),!r&&o&&(o=!1,t("close"))}),ne({popupRef:l}),Ke(l,()=>e.show&&e.lockScroll),J("popstate",()=>{e.closeOnPopstate&&(u(),a=!1)}),te(()=>{e.show&&v()}),Oe(()=>{a&&(t("update:show",!0),a=!1)}),G(()=>{e.show&&e.teleport&&(u(),a=!0)}),Ie(_e,()=>e.show),()=>e.teleport?i(Z,{to:e.teleport},{default:()=>[y(),j()]}):i(ke,null,[y(),j()])}});const Ze=N(We);let T=0;function Qe(e){e?(T||document.body.classList.add("van-toast--unclickable"),T++):T&&(T--,T||document.body.classList.remove("van-toast--unclickable"))}const[et,b]=E("toast"),tt=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],nt={icon:String,show:Boolean,type:I("text"),overlay:Boolean,message:O,iconSize:O,duration:be(2e3),position:I("middle"),teleport:[String,Object],wordBreak:String,className:_,iconPrefix:String,transition:I("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:_,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:O};var ot=D({name:et,props:nt,emits:["update:show"],setup(e,{emit:t,slots:n}){let s,o=!1;const a=()=>{const u=e.show&&e.forbidClick;o!==u&&(o=u,Qe(o))},c=u=>t("update:show",u),l=()=>{e.closeOnClick&&c(!1)},d=()=>clearTimeout(s),k=()=>{const{icon:u,type:f,iconSize:y,iconPrefix:h,loadingType:C}=e;if(u||f==="success"||f==="fail")return i(oe,{name:u||f,size:y,class:b("icon"),classPrefix:h},null);if(f==="loading")return i(je,{class:b("loading"),size:y,type:C},null)},v=()=>{const{type:u,message:f}=e;if(n.message)return i("div",{class:b("text")},[n.message()]);if($(f)&&f!=="")return u==="html"?i("div",{key:0,class:b("text"),innerHTML:String(f)},null):i("div",{class:b("text")},[f])};return P(()=>[e.show,e.forbidClick],a),P(()=>[e.show,e.type,e.message,e.duration],()=>{d(),e.show&&e.duration>0&&(s=setTimeout(()=>{c(!1)},e.duration))}),te(a),xe(a),()=>i(Ze,B({class:[b([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:l,onClosed:d,"onUpdate:show":c},Pe(e,tt)),{default:()=>[k(),v()]})}});function at(){const e=Te({show:!1}),t=o=>{e.show=o},n=o=>{w(e,o,{transitionAppear:!0}),t(!0)},s=()=>t(!1);return ne({open:n,close:s,toggle:t}),{open:n,close:s,state:e,toggle:t}}function st(e){const t=pe(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}const lt={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let L=[],ct=!1,X=w({},lt);const it=new Map;function le(e){return Be(e)?e:{message:e}}function rt(){const{instance:e}=st({setup(){const t=m(""),{open:n,state:s,close:o,toggle:a}=at(),c=()=>{},l=()=>i(ot,B(s,{onClosed:c,"onUpdate:show":a}),null);return P(t,d=>{s.message=d}),Ae().render=l,{open:n,close:o,message:t}}});return e}function ut(){if(!L.length||ct){const e=rt();L.push(e)}return L[L.length-1]}function dt(e={}){if(!ze)return{};const t=ut(),n=le(e);return t.open(w({},X,it.get(n.type||X.type),n)),t}const R=e=>t=>dt(w({type:e},le(t))),Ot=R("loading"),kt=R("success"),St=R("fail");export{je as L,Ze as P,gt as a,at as b,dt as c,kt as d,Ot as e,ot as f,st as m,ae as p,St as s,Fe as u};
