import{d as D,Y as k,y as I,q as E,k as V,p as w,ai as ve,b as i,a9 as ye,A as N,x,af as _,r as m,K as me,W as G,X as he,w as P,aF as Ce,z as q,L as J,aG as W,as as Z,$ as ge,P as $,D as Q,M as ee,v as B,j as te,a6 as ke,F as Oe,aH as Se,a1 as we,ax as Ie,ak as be,aI as xe,s as Pe,aJ as pe,J as Te,V as ze,ar as Be,ae as Ae}from"./index-Dm3XJQou.js";import{u as oe}from"./use-expose-vS_P2JAw.js";import{T as F,H as Le,I as ne}from"./index-DNtSWX2c.js";import{P as _e}from"./on-popup-reopen-CZFnVv-D.js";import{u as K}from"./use-scope-id-dXzTiNx8.js";import{c as De}from"./interceptor-Cmlr3lpm.js";const[Ee,z]=E("loading"),Me=Array(12).fill(null).map((e,t)=>i("i",{class:z("line",String(t+1))},null)),Ne=i("svg",{class:z("circular"),viewBox:"25 25 50 50"},[i("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),$e={size:k,type:I("circular"),color:String,vertical:Boolean,textSize:k,textColor:String};var Re=D({name:Ee,props:$e,setup(e,{slots:t}){const o=V(()=>w({color:e.color},ve(e.size))),s=()=>{const a=e.type==="spinner"?Me:Ne;return i("span",{class:z("spinner",e.type),style:o.value},[t.icon?t.icon():a])},n=()=>{var a;if(t.default)return i("span",{class:z("text"),style:{fontSize:ye(e.textSize),color:(a=e.textColor)!=null?a:e.color}},[t.default()])};return()=>{const{type:a,vertical:c}=e;return i("div",{class:z([a,{vertical:c}]),"aria-live":"polite","aria-busy":!0},[s(),n()])}}});const je=N(Re),ae={show:Boolean,zIndex:k,overlay:x,duration:k,teleport:[String,Object],lockScroll:x,lazyRender:x,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:_,transitionAppear:Boolean,closeOnClickOverlay:x},gt=Object.keys(ae);function Ye(e,t){return e>t?"horizontal":t>e?"vertical":""}function Fe(){const e=m(0),t=m(0),o=m(0),s=m(0),n=m(0),a=m(0),c=m(""),l=m(!0),d=()=>c.value==="vertical",O=()=>c.value==="horizontal",v=()=>{o.value=0,s.value=0,n.value=0,a.value=0,c.value="",l.value=!0};return{move:y=>{const h=y.touches[0];o.value=(h.clientX<0?0:h.clientX)-e.value,s.value=h.clientY-t.value,n.value=Math.abs(o.value),a.value=Math.abs(s.value);const C=10;(!c.value||n.value<C&&a.value<C)&&(c.value=Ye(n.value,a.value)),l.value&&(n.value>F||a.value>F)&&(l.value=!1)},start:y=>{v(),e.value=y.touches[0].clientX,t.value=y.touches[0].clientY},reset:v,startX:e,startY:t,deltaX:o,deltaY:s,offsetX:n,offsetY:a,direction:c,isVertical:d,isHorizontal:O,isTap:l}}let p=0;const H="van-overflow-hidden";function Ke(e,t){const o=Fe(),s="01",n="10",a=v=>{o.move(v);const u=o.deltaY.value>0?n:s,f=Ce(v.target,e.value),{scrollHeight:y,offsetHeight:h,scrollTop:C}=f;let g="11";C===0?g=h>=y?"00":"01":C+h>=y&&(g="10"),g!=="11"&&o.isVertical()&&!(parseInt(g,2)&parseInt(u,2))&&q(v,!0)},c=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",a,{passive:!1}),p||document.body.classList.add(H),p++},l=()=>{p&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",a),p--,p||document.body.classList.remove(H))},d=()=>t()&&c(),O=()=>t()&&l();me(d),G(O),he(O),P(t,v=>{v?c():l()})}function se(e){const t=m(!1);return P(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[He,Ue]=E("overlay"),Xe={show:Boolean,zIndex:k,duration:k,className:_,lockScroll:x,lazyRender:x,customStyle:Object,teleport:[String,Object]};var Ve=D({name:He,inheritAttrs:!1,props:Xe,setup(e,{attrs:t,slots:o}){const s=m(),n=se(()=>e.show||!e.lazyRender),a=l=>{e.lockScroll&&q(l,!0)},c=n(()=>{var l;const d=w(ge(e.zIndex),e.customStyle);return $(e.duration)&&(d.animationDuration=`${e.duration}s`),Q(i("div",B({ref:s,style:d,class:[Ue(),e.className]},t),[(l=o.default)==null?void 0:l.call(o)]),[[ee,e.show]])});return J("touchmove",a,{target:s}),()=>{const l=i(W,{name:"van-fade",appear:!0},{default:c});return e.teleport?i(Z,{to:e.teleport},{default:()=>[l]}):l}}});const Ge=N(Ve),qe=w({},ae,{round:Boolean,position:I("center"),closeIcon:I("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:I("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Je,U]=E("popup");var We=D({name:Je,inheritAttrs:!1,props:qe,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:s}){let n,a;const c=m(),l=m(),d=se(()=>e.show||!e.lazyRender),O=V(()=>{const r={zIndex:c.value};if($(e.duration)){const S=e.position==="center"?"animationDuration":"transitionDuration";r[S]=`${e.duration}s`}return r}),v=()=>{n||(n=!0,c.value=e.zIndex!==void 0?+e.zIndex:Se(),t("open"))},u=()=>{n&&De(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},f=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&u()},y=()=>{if(e.overlay){const r=w({show:e.show,class:e.overlayClass,zIndex:c.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return i(Ge,B(r,K(),{onClick:f}),{default:s["overlay-content"]})}},h=r=>{t("clickCloseIcon",r),u()},C=()=>{if(e.closeable)return i(ne,{role:"button",tabindex:0,name:e.closeIcon,class:[U("close-icon",e.closeIconPosition),Le],classPrefix:e.iconPrefix,onClick:h},null)};let g;const ce=()=>{g&&clearTimeout(g),g=setTimeout(()=>{t("opened")})},ie=()=>t("closed"),re=r=>t("keydown",r),ue=d(()=>{var r;const{destroyOnClose:S,round:M,position:A,safeAreaInsetTop:de,safeAreaInsetBottom:fe,show:Y}=e;if(!(!Y&&S))return Q(i("div",B({ref:l,style:O.value,role:"dialog",tabindex:0,class:[U({round:M,[A]:A}),{"van-safe-area-top":de,"van-safe-area-bottom":fe}],onKeydown:re},o,K()),[(r=s.default)==null?void 0:r.call(s),C()]),[[ee,Y]])}),j=()=>{const{position:r,transition:S,transitionAppear:M}=e,A=r==="center"?"van-fade":`van-popup-slide-${r}`;return i(W,{name:S||A,appear:M,onAfterEnter:ce,onAfterLeave:ie},{default:ue})};return P(()=>e.show,r=>{r&&!n&&(v(),o.tabindex===0&&we(()=>{var S;(S=l.value)==null||S.focus()})),!r&&n&&(n=!1,t("close"))}),oe({popupRef:l}),Ke(l,()=>e.show&&e.lockScroll),J("popstate",()=>{e.closeOnPopstate&&(u(),a=!1)}),te(()=>{e.show&&v()}),ke(()=>{a&&(t("update:show",!0),a=!1)}),G(()=>{e.show&&e.teleport&&(u(),a=!0)}),Ie(_e,()=>e.show),()=>e.teleport?i(Z,{to:e.teleport},{default:()=>[y(),j()]}):i(Oe,null,[y(),j()])}});const Ze=N(We);let T=0;function Qe(e){e?(T||document.body.classList.add("van-toast--unclickable"),T++):T&&(T--,T||document.body.classList.remove("van-toast--unclickable"))}const[et,b]=E("toast"),tt=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],ot={icon:String,show:Boolean,type:I("text"),overlay:Boolean,message:k,iconSize:k,duration:be(2e3),position:I("middle"),teleport:[String,Object],wordBreak:String,className:_,iconPrefix:String,transition:I("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:_,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:k};var nt=D({name:et,props:ot,emits:["update:show"],setup(e,{emit:t,slots:o}){let s,n=!1;const a=()=>{const u=e.show&&e.forbidClick;n!==u&&(n=u,Qe(n))},c=u=>t("update:show",u),l=()=>{e.closeOnClick&&c(!1)},d=()=>clearTimeout(s),O=()=>{const{icon:u,type:f,iconSize:y,iconPrefix:h,loadingType:C}=e;if(u||f==="success"||f==="fail")return i(ne,{name:u||f,size:y,class:b("icon"),classPrefix:h},null);if(f==="loading")return i(je,{class:b("loading"),size:y,type:C},null)},v=()=>{const{type:u,message:f}=e;if(o.message)return i("div",{class:b("text")},[o.message()]);if($(f)&&f!=="")return u==="html"?i("div",{key:0,class:b("text"),innerHTML:String(f)},null):i("div",{class:b("text")},[f])};return P(()=>[e.show,e.forbidClick],a),P(()=>[e.show,e.type,e.message,e.duration],()=>{d(),e.show&&e.duration>0&&(s=setTimeout(()=>{c(!1)},e.duration))}),te(a),xe(a),()=>i(Ze,B({class:[b([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:l,onClosed:d,"onUpdate:show":c},Pe(e,tt)),{default:()=>[O(),v()]})}});function at(){const e=Te({show:!1}),t=n=>{e.show=n},o=n=>{w(e,n,{transitionAppear:!0}),t(!0)},s=()=>t(!1);return oe({open:o,close:s,toggle:t}),{open:o,close:s,state:e,toggle:t}}function st(e){const t=pe(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const lt={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let L=[],ct=!1,X=w({},lt);const it=new Map;function le(e){return Be(e)?e:{message:e}}function rt(){const{instance:e}=st({setup(){const t=m(""),{open:o,state:s,close:n,toggle:a}=at(),c=()=>{},l=()=>i(nt,B(s,{onClosed:c,"onUpdate:show":a}),null);return P(t,d=>{s.message=d}),Ae().render=l,{open:o,close:n,message:t}}});return e}function ut(){if(!L.length||ct){const e=rt();L.push(e)}return L[L.length-1]}function dt(e={}){if(!ze)return{};const t=ut(),o=le(e);return t.open(w({},X,it.get(o.type||X.type),o)),t}const R=e=>t=>dt(w({type:e},le(t))),kt=R("loading"),Ot=R("success"),St=R("fail");export{je as L,Ze as P,gt as a,dt as b,Ot as c,kt as d,at as e,nt as f,st as m,ae as p,St as s,Fe as u};
