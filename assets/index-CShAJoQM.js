import{I as q,b as J,c as X}from"./index-DNtSWX2c.js";import{d as L,x as w,q as _,r as S,a4 as G,b as a,A as H,p as k,ac as Q,k as $,y as R,Y as P,ae as Z,a9 as O,P as p,w as ee,V,X as ne,j as te,a1 as K,D as oe,C as ae,v as D,J as re,ay as le,s as se,af as ie,az as U,aA as ce}from"./index-Dm3XJQou.js";import{P as ue,p as de,a as fe,m as me,e as ge}from"./function-call-zmZdu7iA.js";import{B as F}from"./index-BhEJRcLJ.js";import{u as ve}from"./use-placeholder-y9DvGg_K.js";import{u as Be}from"./use-expose-vS_P2JAw.js";import{u as he,a as be}from"./use-route-BcEUn9xt.js";import{c as ye}from"./interceptor-Cmlr3lpm.js";const[W,j]=_("action-bar"),Y=Symbol(W),we={placeholder:Boolean,safeAreaInsetBottom:w};var Ce=L({name:W,props:we,setup(e,{slots:s}){const o=S(),l=ve(o,j),{linkChildren:r}=G(Y);r();const c=()=>{var u;return a("div",{ref:o,class:[j(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(u=s.default)==null?void 0:u.call(s)])};return()=>e.placeholder?l(c):c()}});const Pe=H(Ce),[Se,ke]=_("action-bar-button"),xe=k({},be,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Ee=L({name:Se,props:xe,setup(e,{slots:s}){const o=he(),{parent:l,index:r}=Q(Y),c=$(()=>{if(l){const d=l.children[r.value-1];return!(d&&"isButton"in d)}}),u=$(()=>{if(l){const d=l.children[r.value+1];return!(d&&"isButton"in d)}});return Be({isButton:!0}),()=>{const{type:d,icon:m,text:g,color:h,loading:b,disabled:C}=e;return a(F,{class:ke([d,{last:u.value,first:c.value}]),size:"large",type:d,icon:m,color:h,loading:b,disabled:C,onClick:o},{default:()=>[s.default?s.default():g]})}}});const M=H(Ee),[Ie,y]=_("image"),Te={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:P,height:P,radius:P,lazyLoad:Boolean,iconSize:P,showError:w,errorIcon:R("photo-fail"),iconPrefix:String,showLoading:w,loadingIcon:R("photo"),crossorigin:String,referrerpolicy:String,decoding:String};var Oe=L({name:Ie,props:Te,emits:["load","error"],setup(e,{emit:s,slots:o}){const l=S(!1),r=S(!0),c=S(),{$Lazyload:u}=Z().proxy,d=$(()=>{const t={width:O(e.width),height:O(e.height)};return p(e.radius)&&(t.overflow="hidden",t.borderRadius=O(e.radius)),t});ee(()=>e.src,()=>{l.value=!1,r.value=!0});const m=t=>{r.value&&(r.value=!1,s("load",t))},g=()=>{const t=new Event("load");Object.defineProperty(t,"target",{value:c.value,enumerable:!0}),m(t)},h=t=>{l.value=!0,r.value=!1,s("error",t)},b=(t,n,i)=>i?i():a(q,{name:t,size:e.iconSize,class:n,classPrefix:e.iconPrefix},null),C=()=>{if(r.value&&e.showLoading)return a("div",{class:y("loading")},[b(e.loadingIcon,y("loading-icon"),o.loading)]);if(l.value&&e.showError)return a("div",{class:y("error")},[b(e.errorIcon,y("error-icon"),o.error)])},z=()=>{if(l.value||!e.src)return;const t={alt:e.alt,class:y("img"),decoding:e.decoding,style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?oe(a("img",D({ref:c},t),null),[[ae("lazy"),e.src]]):a("img",D({ref:c,src:e.src,onLoad:m,onError:h},t),null)},x=({el:t})=>{const n=()=>{t===c.value&&r.value&&g()};c.value?n():K(n)},E=({el:t})=>{t===c.value&&!l.value&&h()};return u&&V&&(u.$on("loaded",x),u.$on("error",E),ne(()=>{u.$off("loaded",x),u.$off("error",E)})),te(()=>{K(()=>{var t;(t=c.value)!=null&&t.complete&&!e.lazyLoad&&g()})}),()=>{var t;return a("div",{class:y({round:e.round,block:e.block}),style:d.value},[z(),C(),(t=o.default)==null?void 0:t.call(o)])}}});const Ye=H(Oe),[De,f,T]=_("dialog"),Le=k({},de,{title:String,theme:String,width:P,message:[String,Function],callback:Function,allowHtml:Boolean,className:ie,transition:R("van-dialog-bounce"),messageAlign:String,closeOnPopstate:w,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:w,closeOnClickOverlay:Boolean,keyboardEnabled:w,destroyOnClose:Boolean}),_e=[...fe,"transition","closeOnPopstate","destroyOnClose"];var ze=L({name:De,props:Le,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:s,slots:o}){const l=S(),r=re({confirm:!1,cancel:!1}),c=n=>s("update:show",n),u=n=>{var i;c(!1),(i=e.callback)==null||i.call(e,n)},d=n=>()=>{e.show&&(s(n),e.beforeClose?(r[n]=!0,ye(e.beforeClose,{args:[n],done(){u(n),r[n]=!1},canceled(){r[n]=!1}})):u(n))},m=d("cancel"),g=d("confirm"),h=le(n=>{var i,v;if(!e.keyboardEnabled||n.target!==((v=(i=l.value)==null?void 0:i.popupRef)==null?void 0:v.value))return;({Enter:e.showConfirmButton?g:U,Escape:e.showCancelButton?m:U})[n.key](),s("keydown",n)},["enter","esc"]),b=()=>{const n=o.title?o.title():e.title;if(n)return a("div",{class:f("header",{isolated:!e.message&&!o.default})},[n])},C=n=>{const{message:i,allowHtml:v,messageAlign:B}=e,I=f("message",{"has-title":n,[B]:B}),A=ce(i)?i():i;return v&&typeof A=="string"?a("div",{class:I,innerHTML:A},null):a("div",{class:I},[A])},z=()=>{if(o.default)return a("div",{class:f("content")},[o.default()]);const{title:n,message:i,allowHtml:v}=e;if(i){const B=!!(n||o.title);return a("div",{key:v?1:0,class:f("content",{isolated:!B})},[C(B)])}},x=()=>a("div",{class:[X,f("footer")]},[e.showCancelButton&&a(F,{size:"large",text:e.cancelButtonText||T("cancel"),class:f("cancel"),style:{color:e.cancelButtonColor},loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:m},null),e.showConfirmButton&&a(F,{size:"large",text:e.confirmButtonText||T("confirm"),class:[f("confirm"),{[J]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),E=()=>a(Pe,{class:f("footer")},{default:()=>[e.showCancelButton&&a(M,{type:"warning",text:e.cancelButtonText||T("cancel"),class:f("cancel"),color:e.cancelButtonColor,loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:m},null),e.showConfirmButton&&a(M,{type:"danger",text:e.confirmButtonText||T("confirm"),class:f("confirm"),color:e.confirmButtonColor,loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),t=()=>o.footer?o.footer():e.theme==="round-button"?E():x();return()=>{const{width:n,title:i,theme:v,message:B,className:I}=e;return a(ue,D({ref:l,role:"dialog",class:[f([v]),I],style:{width:O(n)},tabindex:0,"aria-labelledby":i||B,onKeydown:h,"onUpdate:show":c},se(e,_e)),{default:()=>[b(),z(),t()]})}}});let N;const Ae={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,destroyOnClose:!1};let $e=k({},Ae);function Re(){({instance:N}=me({setup(){const{state:s,toggle:o}=ge();return()=>a(ze,D(s,{"onUpdate:show":o}),null)}}))}function Fe(e){return V?new Promise((s,o)=>{N||Re(),N.open(k({},$e,e,{callback:l=>{(l==="confirm"?s:o)(l)}}))}):Promise.resolve(void 0)}const qe=e=>Fe(k({showCancelButton:!0},e));export{Ye as I,qe as a,ze as s};
