import{d as R,Y as V,x as k,y as K,I as Y,q as W,r as O,a4 as Z,Z as j,k as T,P as q,au as F,L as J,b as r,N as _,a3 as U,af as A,E as G,J as Q,ac as X,aw as ee,$ as te,ax as oe,D as ae,M as ne,v as se,A as N}from"./index-BeP3gcyx.js";import{u as B}from"./use-expose-CQIS9pGU.js";import{C as le}from"./index-CQ6M4_C4.js";import{I as re}from"./_plugin-vue_export-helper-B23Ac8Lp.js";import{P as ie}from"./index-CamQlpZW.js";import{u as ce}from"./use-id-BK2jniW6.js";import{H as de}from"./use-route-IHgQ6GTt.js";const[L,b]=W("dropdown-menu"),ue={overlay:k,zIndex:V,duration:Y(.2),direction:K("down"),activeColor:String,autoLocate:Boolean,closeOnClickOutside:k,closeOnClickOverlay:k,swipeThreshold:V},H=Symbol(L);var pe=R({name:L,props:ue,setup(t,{slots:i}){const c=ce(),p=O(),o=O(),d=O(0),{children:n,linkChildren:x}=Z(H),f=j(p),m=T(()=>n.some(e=>e.state.showWrapper)),h=T(()=>t.swipeThreshold&&n.length>+t.swipeThreshold),I=T(()=>{if(m.value&&q(t.zIndex))return{zIndex:+t.zIndex+1}}),C=()=>{n.forEach(e=>{e.toggle(!1)})},S=()=>{t.closeOnClickOutside&&C()},P=()=>{if(o.value){const e=_(o);t.direction==="down"?d.value=e.bottom:d.value=U.value-e.top}},$=()=>{m.value&&P()},D=e=>{n.forEach((a,s)=>{s===e?a.toggle():a.state.showPopup&&a.toggle(!1,{immediate:!0})})},g=(e,a)=>{const{showPopup:s}=e.state,{disabled:l,titleClass:v}=e;return r("div",{id:`${c}-${a}`,role:"button",tabindex:l?void 0:0,"data-allow-mismatch":"attribute",class:[b("item",{disabled:l,grow:h.value}),{[de]:!l}],onClick:()=>{l||D(a)}},[r("span",{class:[b("title",{down:s===(t.direction==="down"),active:s}),v],style:{color:s?t.activeColor:""}},[r("div",{class:"van-ellipsis"},[e.renderTitle()])])])};return B({close:C}),x({id:c,props:t,offset:d,updateOffset:P}),F(p,S),J("scroll",$,{target:f,passive:!0}),()=>{var e;return r("div",{ref:p,class:b()},[r("div",{ref:o,style:I.value,class:b("bar",{opened:m.value,scrollable:h.value})},[n.map(g)]),(e=i.default)==null?void 0:e.call(i)])}}});const[fe,y]=W("dropdown-item"),me={title:String,options:G(),disabled:Boolean,teleport:[String,Object],lazyRender:k,modelValue:A,titleClass:A};var ve=R({name:fe,inheritAttrs:!1,props:me,emits:["open","opened","close","closed","change","update:modelValue"],setup(t,{emit:i,slots:c,attrs:p}){const o=Q({showPopup:!1,transition:!0,showWrapper:!1}),d=O(),{parent:n,index:x}=X(H);if(!n)return;const f=e=>()=>i(e),m=f("open"),h=f("close"),I=f("opened"),C=()=>{o.showWrapper=!1,i("closed")},S=e=>{t.teleport&&e.stopPropagation()},P=(e=!o.showPopup,a={})=>{e!==o.showPopup&&(o.showPopup=e,o.transition=!a.immediate,e&&(n.updateOffset(),o.showWrapper=!0))},$=()=>{if(c.title)return c.title();if(t.title)return t.title;const e=t.options.find(a=>a.value===t.modelValue);return e?e.text:""},D=e=>{const{activeColor:a}=n.props,{disabled:s}=e,l=e.value===t.modelValue,v=()=>{s||(o.showPopup=!1,e.value!==t.modelValue&&(i("update:modelValue",e.value),i("change",e.value)))},w=()=>{if(l)return r(re,{class:y("icon"),color:s?void 0:a,name:"success"},null)};return r(le,{role:"menuitem",key:String(e.value),icon:e.icon,title:e.text,class:y("option",{active:l,disabled:s}),style:{color:l?a:""},tabindex:l?0:-1,clickable:!s,onClick:v},{value:w})},g=()=>{const{offset:e}=n,{autoLocate:a,zIndex:s,overlay:l,duration:v,direction:w,closeOnClickOverlay:M}=n.props,E=te(s);let z=e.value;if(a&&d.value){const u=oe(d.value);u&&(z-=_(u).top)}return w==="down"?E.top=`${z}px`:E.bottom=`${z}px`,ae(r("div",se({ref:d,style:E,class:y([w]),onClick:S},p),[r(ie,{show:o.showPopup,"onUpdate:show":u=>o.showPopup=u,role:"menu",class:y("content"),overlay:l,position:w==="down"?"top":"bottom",duration:o.transition?v:0,lazyRender:t.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${n.id}-${x.value}`,"data-allow-mismatch":"attribute",closeOnClickOverlay:M,onOpen:m,onClose:h,onOpened:I,onClosed:C},{default:()=>{var u;return[t.options.map(D),(u=c.default)==null?void 0:u.call(c)]}})]),[[ne,o.showWrapper]])};return B({state:o,toggle:P,renderTitle:$}),()=>t.teleport?r(ee,{to:t.teleport},{default:()=>[g()]}):g()}});const ke=N(ve),Oe=N(pe);export{Oe as D,ke as a};
